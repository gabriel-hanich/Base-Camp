{"ast":null,"code":"import { DOCUMENT } from '@angular/common';\nimport { EventEmitter } from '@angular/core';\nimport { ktdTrackById } from '@katoid/angular-grid-layout';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/globals/global-vars.service\";\nimport * as i2 from \"../../ui-components/heading-component/heading-component.component\";\nimport * as i3 from \"@katoid/angular-grid-layout\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"../../widgets/timetable-column/timetable-column.component\";\nimport * as i6 from \"../../widgets/day-spinner/day-spinner.component\";\nimport * as i7 from \"../../widgets/note-widget/note-widget.component\";\nimport * as i8 from \"@angular/material/form-field\";\nimport * as i9 from \"@angular/material/select\";\nimport * as i10 from \"@angular/material/core\";\n\nfunction HomePageComponent_ktd_grid_item_5_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 22)(1, \"img\", 15);\n    i0.ɵɵlistener(\"click\", function HomePageComponent_ktd_grid_item_5_div_1_Template_img_click_1_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const item_r1 = i0.ɵɵnextContext().$implicit;\n      const ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.deleteWidget(item_r1.id);\n    });\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction HomePageComponent_ktd_grid_item_5_app_timetable_column_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-timetable-column\", 23);\n  }\n\n  if (rf & 2) {\n    const item_r1 = i0.ɵɵnextContext().$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"displaySettings\", ctx_r3.editableWidgets)(\"id\", item_r1.id)(\"toggleEmitter\", ctx_r3.timeEmitter);\n  }\n}\n\nfunction HomePageComponent_ktd_grid_item_5_app_day_spinner_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-day-spinner\", 24);\n    i0.ɵɵlistener(\"btnPress\", function HomePageComponent_ktd_grid_item_5_app_day_spinner_4_Template_app_day_spinner_btnPress_0_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext(2);\n      return ctx_r10.toggleTimeDisplay();\n    });\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction HomePageComponent_ktd_grid_item_5_app_note_widget_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-note-widget\", 25);\n  }\n\n  if (rf & 2) {\n    const item_r1 = i0.ɵɵnextContext().$implicit;\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"displaySettings\", ctx_r5.editableWidgets)(\"id\", item_r1.id);\n  }\n}\n\nfunction HomePageComponent_ktd_grid_item_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ktd-grid-item\", 16);\n    i0.ɵɵtemplate(1, HomePageComponent_ktd_grid_item_5_div_1_Template, 2, 0, \"div\", 17);\n    i0.ɵɵelementStart(2, \"div\", 18);\n    i0.ɵɵtemplate(3, HomePageComponent_ktd_grid_item_5_app_timetable_column_3_Template, 1, 3, \"app-timetable-column\", 19);\n    i0.ɵɵtemplate(4, HomePageComponent_ktd_grid_item_5_app_day_spinner_4_Template, 1, 0, \"app-day-spinner\", 20);\n    i0.ɵɵtemplate(5, HomePageComponent_ktd_grid_item_5_app_note_widget_5_Template, 1, 2, \"app-note-widget\", 21);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const item_r1 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵpropertyInterpolate(\"draggable\", ctx_r0.editableWidgets);\n    i0.ɵɵpropertyInterpolate(\"resizable\", false);\n    i0.ɵɵproperty(\"id\", item_r1.id.toString());\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.editableWidgets);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", item_r1.presetType == \"timetableDay\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", item_r1.presetType == \"timeBtn\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", item_r1.presetType == \"note\");\n  }\n}\n\nexport let HomePageComponent = /*#__PURE__*/(() => {\n  class HomePageComponent {\n    constructor(document, globalVars) {\n      this.document = document;\n      this.globalVars = globalVars;\n      this.userName = this.globalVars.getVar(\"userName\");\n      this.timeText = \"00:00\";\n      this.layout = [];\n      this.layoutData = [];\n      this.trackById = ktdTrackById;\n      this.compactType = null;\n      this.newWidgetType = \"timetableDay\";\n      this.editableWidgets = false;\n      this.timeEmitter = new EventEmitter();\n      this.colCount = Math.round(screen.width / 130);\n    }\n\n    ngOnInit() {\n      try {\n        this.layoutData = JSON.parse(this.globalVars.getVar(\"widgetsLayout\"));\n      } catch (SyntaxError) {\n        this.layoutData = [];\n      }\n\n      this.updateTime();\n      this.renderBoards();\n      const loginTime = new Date();\n\n      if (loginTime.getHours() < 10) {\n        this.greetingText = \"Good Morning\";\n      } else if (loginTime.getHours() < 15) {\n        this.greetingText = \"Hello\";\n      } else if (loginTime.getHours() < 18) {\n        this.greetingText = \"Good Afternoon\";\n      } else {\n        this.greetingText = \"Good Evening\";\n      }\n\n      setInterval(() => {\n        this.updateTime();\n      }, 1000);\n    }\n\n    updateTime() {\n      var currentTime = new Date();\n      var suffix = \"am\";\n      var hours = currentTime.getHours();\n\n      if (hours > 12) {\n        hours -= 12;\n        suffix = \"pm\";\n      }\n\n      var minutes = currentTime.getMinutes().toString();\n\n      if (minutes.length == 1) {\n        minutes = \"0\" + minutes;\n      }\n\n      this.timeText = hours.toString() + \":\" + minutes + suffix;\n    }\n\n    renderBoards() {\n      // Convert locally stored layoutData into KtdGridLayout\n      console.log(\"AA\");\n      let newLayout = this.layout;\n      console.log(\"BB\");\n\n      for (var i = 0; i < this.layoutData.length; i++) {\n        let renderBoard = true; // Only render the board if it is new\n\n        for (var k = 0; k < newLayout.length; k++) {\n          if (newLayout[k].id == this.layoutData[i].id.toString()) {\n            renderBoard = false;\n          }\n        }\n\n        if (renderBoard) {\n          console.log(\"RENDERING NEW BOARD\");\n          newLayout.push({\n            \"id\": this.layoutData[i].id.toString(),\n            \"x\": this.layoutData[i].x,\n            \"y\": this.layoutData[i].y,\n            \"h\": this.layoutData[i].height,\n            \"w\": this.layoutData[i].width\n          });\n        }\n      }\n\n      this.layout = newLayout;\n    }\n\n    addNewWidget() {\n      let lastLayout = this.layoutData[this.layoutData.length - 1];\n      let height = 6;\n      let width = 3;\n\n      if (this.newWidgetType === \"timeBtn\") {\n        height = 1;\n        width = 1;\n      } else if (this.newWidgetType === \"note\") {\n        width = 4;\n      }\n\n      if (this.layoutData.length != 0) {\n        // If this ISN'T the first widget on screen\n        this.layoutData.push({\n          id: lastLayout.id + 1,\n          x: lastLayout.x + lastLayout.width + 1,\n          y: 0,\n          height: height,\n          width: width,\n          presetType: this.newWidgetType\n        });\n      } else {\n        this.layoutData.push({\n          id: 0,\n          x: 0,\n          y: 0,\n          height: height,\n          width: width,\n          presetType: this.newWidgetType\n        });\n      }\n\n      this.globalVars.setVar(\"widgetsLayout\", JSON.stringify(this.layoutData));\n      setTimeout(() => {\n        this.renderBoards();\n      }, 100);\n    }\n\n    deleteWidget(id) {\n      let newLayout = [];\n\n      for (var i = 0; i < this.layoutData.length; i++) {\n        if (this.layoutData[i].id != id) {\n          newLayout.push(this.layoutData[i]);\n        }\n      }\n\n      this.globalVars.setVar(\"widgetsLayout\", JSON.stringify(newLayout));\n      setTimeout(() => {\n        window.location.reload();\n      }, 100);\n    }\n\n    toggleWidgetEditing() {\n      var _a;\n\n      this.editableWidgets = !this.editableWidgets;\n      (_a = document.getElementById(\"adjustContainer\")) === null || _a === void 0 ? void 0 : _a.classList.toggle('pulledUp');\n    }\n\n    saveLayout(currentLayout) {\n      setTimeout(() => {\n        for (var i = 0; i < currentLayout.length; i++) {\n          this.layoutData[i].x = currentLayout[i].x;\n          this.layoutData[i].y = currentLayout[i].y;\n          this.layoutData[i].height = currentLayout[i].h;\n          this.layoutData[i].width = this.layout[i].w;\n        }\n\n        this.globalVars.setVar(\"widgetsLayout\", JSON.stringify(this.layoutData));\n      }, 150);\n    }\n\n    toggleTimeDisplay() {\n      this.timeEmitter.emit(\"Pressed\");\n    }\n\n  }\n\n  HomePageComponent.ɵfac = function HomePageComponent_Factory(t) {\n    return new (t || HomePageComponent)(i0.ɵɵdirectiveInject(DOCUMENT), i0.ɵɵdirectiveInject(i1.GlobalVarsService));\n  };\n\n  HomePageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: HomePageComponent,\n    selectors: [[\"app-home-page\"]],\n    decls: 32,\n    vars: 16,\n    consts: [[1, \"page-container\"], [1, \"heading-component-container\"], [3, \"line1Text\", \"line2Text\"], [1, \"widgets-container\"], [\"scrollSpeed\", \"4\", 1, \"widgets-grid\", 3, \"cols\", \"rowHeight\", \"layout\", \"compactType\", \"preventCollision\", \"scrollableParent\", \"layoutUpdated\"], [\"class\", \"widgets-item\", 3, \"id\", \"draggable\", \"resizable\", 4, \"ngFor\", \"ngForOf\"], [1, \"edit-container\"], [\"src\", \"../../../../assets/settings.svg\", \"alt\", \"Settings\", 1, \"white\", \"edit-img\", 3, \"click\"], [\"id\", \"adjustContainer\", 1, \"adjust-container\"], [1, \"title\"], [1, \"adjust-new-container\"], [\"appearance\", \"fill\", 1, \"adjust-new-field\"], [1, \"adjust-new-select\", 3, \"value\", \"valueChange\"], [1, \"mat-option\", 3, \"value\"], [1, \"adjust-new-btn\", \"animated-hover\", 3, \"click\"], [\"src\", \"../../../../assets/close.svg\", \"alt\", \"Settings\", 1, \"white\", \"edit-img\", 3, \"click\"], [1, \"widgets-item\", 3, \"id\", \"draggable\", \"resizable\"], [\"class\", \"close-container\", 4, \"ngIf\"], [1, \"widgets-content-container\"], [3, \"displaySettings\", \"id\", \"toggleEmitter\", 4, \"ngIf\"], [3, \"btnPress\", 4, \"ngIf\"], [3, \"displaySettings\", \"id\", 4, \"ngIf\"], [1, \"close-container\"], [3, \"displaySettings\", \"id\", \"toggleEmitter\"], [3, \"btnPress\"], [3, \"displaySettings\", \"id\"]],\n    template: function HomePageComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n        i0.ɵɵelement(2, \"app-heading-component\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"div\", 3)(4, \"ktd-grid\", 4);\n        i0.ɵɵlistener(\"layoutUpdated\", function HomePageComponent_Template_ktd_grid_layoutUpdated_4_listener($event) {\n          return ctx.saveLayout($event);\n        });\n        i0.ɵɵtemplate(5, HomePageComponent_ktd_grid_item_5_Template, 6, 7, \"ktd-grid-item\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"div\", 6)(7, \"img\", 7);\n        i0.ɵɵlistener(\"click\", function HomePageComponent_Template_img_click_7_listener() {\n          return ctx.toggleWidgetEditing();\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(8, \"div\", 8)(9, \"h2\", 9);\n        i0.ɵɵtext(10, \"Adjust Widgets \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"div\", 10)(12, \"h3\", 9);\n        i0.ɵɵtext(13, \"Add New Widget of type\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"mat-form-field\", 11)(15, \"mat-label\");\n        i0.ɵɵtext(16, \"Type\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"mat-select\", 12);\n        i0.ɵɵlistener(\"valueChange\", function HomePageComponent_Template_mat_select_valueChange_17_listener($event) {\n          return ctx.newWidgetType = $event;\n        });\n        i0.ɵɵelementStart(18, \"mat-option\", 13);\n        i0.ɵɵtext(19, \"Timetable Day\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"mat-option\", 13);\n        i0.ɵɵtext(21, \"Time Button\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"mat-option\", 13);\n        i0.ɵɵtext(23, \"Note\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"mat-option\", 13);\n        i0.ɵɵtext(25, \"News Feed\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"mat-option\", 13);\n        i0.ɵɵtext(27, \"Study Note\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(28, \"button\", 14);\n        i0.ɵɵlistener(\"click\", function HomePageComponent_Template_button_click_28_listener() {\n          return ctx.addNewWidget();\n        });\n        i0.ɵɵtext(29, \"Add\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(30, \"div\", 6)(31, \"img\", 15);\n        i0.ɵɵlistener(\"click\", function HomePageComponent_Template_img_click_31_listener() {\n          return ctx.toggleWidgetEditing();\n        });\n        i0.ɵɵelementEnd()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵpropertyInterpolate2(\"line1Text\", \"\", ctx.greetingText, \" \", ctx.userName, \"\");\n        i0.ɵɵpropertyInterpolate(\"line2Text\", ctx.timeText);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"cols\", ctx.colCount)(\"rowHeight\", 100)(\"layout\", ctx.layout)(\"compactType\", ctx.compactType)(\"preventCollision\", \"True\")(\"scrollableParent\", \"True\" ? ctx.document : null);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.layoutData);\n        i0.ɵɵadvance(12);\n        i0.ɵɵproperty(\"value\", ctx.newWidgetType);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"value\", \"timetableDay\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"value\", \"timeBtn\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"value\", \"note\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"value\", \"news\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"value\", \"studyNote\");\n      }\n    },\n    directives: [i2.HeadingComponentComponent, i3.KtdGridComponent, i4.NgForOf, i3.KtdGridItemComponent, i4.NgIf, i5.TimetableColumnComponent, i6.DaySpinnerComponent, i7.NoteWidgetComponent, i8.MatFormField, i8.MatLabel, i9.MatSelect, i10.MatOption],\n    styles: [\".widgets-container[_ngcontent-%COMP%]{width:98%;height:75%;margin:15px auto auto}.widgets-grid[_ngcontent-%COMP%]{width:100%;height:100%;max-height:100%;overflow-y:hidden}.widgets-item[_ngcontent-%COMP%]{padding:-10px;border-radius:15px;background:linear-gradient(to top,#0f0c29,#191444);background-attachment:fixed}.widgets-content-container[_ngcontent-%COMP%]{width:95%;height:100%;margin:auto;position:absolute;top:0%;left:50%;transform:translate(-50%);z-index:1!important;overflow-y:hidden;overflow-x:hidden}.edit-container[_ngcontent-%COMP%]{position:absolute;height:50px;aspect-ratio:1/1;bottom:2%;right:1%;background-color:var(--bottom-bg-color);border-radius:15px 0;display:flex;justify-content:center;align-items:center}.edit-img[_ngcontent-%COMP%]{height:65%;width:auto;cursor:pointer;z-index:5}.adjust-container[_ngcontent-%COMP%]{position:fixed;bottom:-20%;height:20%;width:100%;transition:all .5s ease;background-color:var(--bottom-bg-color);z-index:2}.adjust-new-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:15px}.adjust-new-btn[_ngcontent-%COMP%]{height:50px;width:100px;margin-top:-10px;border:none;background-color:var(--mid-bg-color);border-radius:15px 0}.pulledUp[_ngcontent-%COMP%]{bottom:0%!important}.title[_ngcontent-%COMP%]{margin-left:15px}.close-container[_ngcontent-%COMP%]{width:15px;height:auto;position:absolute;top:0%;left:0%;z-index:5}.cover[_ngcontent-%COMP%]{top:0%}@media screen and (max-height: 900px){.adjust-container[_ngcontent-%COMP%]{bottom:-30%;height:30%}}\"]\n  });\n  return HomePageComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}