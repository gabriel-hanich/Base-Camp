{"ast":null,"code":"import { CategoriesListComponent } from '../../ui-components/categories-list/categories-list.component';\nimport { TextInputComponent } from '../../ui-components/text-input/text-input.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/globals/global-vars.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../../ui-components/heading-component/heading-component.component\";\nimport * as i4 from \"@angular/material/form-field\";\nimport * as i5 from \"@angular/material/select\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@angular/material/core\";\nimport * as i8 from \"../../ui-components/categories-list/categories-list.component\";\nimport * as i9 from \"../../ui-components/text-input/text-input.component\";\n\nfunction NewStudyNoteComponent_mat_option_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 12);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const subject_r1 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", subject_r1);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(subject_r1);\n  }\n}\n\nexport let NewStudyNoteComponent = /*#__PURE__*/(() => {\n  class NewStudyNoteComponent {\n    constructor(globalVars, router, route) {\n      this.globalVars = globalVars;\n      this.router = router;\n      this.route = route;\n      this.totalSubjectsList = [];\n      this.currentSubject = \"\";\n      this.categoriesList = [];\n      this.currentContent = \"\";\n      this.noteIndex = -1; // Tracks the current index of the note\n    }\n\n    ngOnInit() {\n      // Get a list containing the names of each subject present in the user's timetable\n      let totalWkData = [];\n\n      try {\n        totalWkData = [JSON.parse(this.globalVars.getVar(\"wk1Data\")), JSON.parse(this.globalVars.getVar(\"wk2Data\"))];\n      } catch (SyntaxError) {}\n\n      for (var i = 0; i < totalWkData.length; i++) {\n        for (var j = 0; j < totalWkData[i].length; j++) {\n          for (var k = 0; k < totalWkData[i][j].length; k++) {\n            if (!this.totalSubjectsList.includes(totalWkData[i][j][k][\"classname\"].split(\":\")[1].trim())) {\n              this.totalSubjectsList.push(totalWkData[i][j][k][\"classname\"].split(\":\")[1].trim());\n            }\n          }\n        }\n      } // Sort alphabetically\n\n\n      this.totalSubjectsList.sort(function (a, b) {\n        var textA = a.toUpperCase();\n        var textB = b.toUpperCase();\n        return textA < textB ? -1 : textA > textB ? 1 : 0;\n      });\n      this.currentSubject = this.totalSubjectsList[0]; // Allow time for page to render before defining categoryInput\n\n      let categoryInput = this.categoryInput;\n      let textInput = this.textInput;\n      setTimeout(() => {\n        categoryInput = this.categoryInput;\n        textInput = this.textInput;\n      }, 450);\n      this.route.params.subscribe(params => {\n        if (Object.keys(params).length !== 0) {\n          let currentNote = JSON.parse(this.globalVars.getVar(\"studyNoteList\"))[params['index']];\n          document.getElementById(\"titleInput\").value = currentNote[\"title\"];\n          this.currentSubject = currentNote[\"subject\"];\n          this.noteIndex = params['index'];\n          setTimeout(() => {\n            categoryInput.setTaglist(currentNote[\"categoryList\"]);\n            textInput.setContent(currentNote[\"content\"]);\n          }, 500);\n        }\n      });\n    }\n\n    updateSubject(subject) {\n      this.currentSubject = subject;\n    }\n\n    updateCategoriesList(value) {\n      this.categoriesList = value;\n    }\n\n    updateContent(content) {\n      this.currentContent = content;\n    }\n\n    addNote() {\n      let currentTitle = document.getElementById(\"titleInput\").value;\n      let currentStudyNotes = JSON.parse(this.globalVars.getVar(\"studyNoteList\"));\n      let thisNote = {\n        \"title\": currentTitle,\n        \"content\": this.currentContent,\n        \"author\": this.globalVars.getVar(\"userName\"),\n        \"timeCreated\": new Date().getTime(),\n        \"categoryList\": this.categoriesList,\n        \"subject\": this.currentSubject\n      };\n\n      if (this.noteIndex == -1 || this.noteIndex - 1 > currentStudyNotes.length) {\n        currentStudyNotes.push(thisNote);\n      } else {\n        currentStudyNotes[this.noteIndex] = thisNote;\n      }\n\n      this.globalVars.setVar(\"studyNoteList\", JSON.stringify(currentStudyNotes));\n      setTimeout(() => {\n        this.router.navigate([\"study_notes\"]);\n      }, 150);\n    }\n\n  }\n\n  NewStudyNoteComponent.ɵfac = function NewStudyNoteComponent_Factory(t) {\n    return new (t || NewStudyNoteComponent)(i0.ɵɵdirectiveInject(i1.GlobalVarsService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i2.ActivatedRoute));\n  };\n\n  NewStudyNoteComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: NewStudyNoteComponent,\n    selectors: [[\"app-new-study-note\"]],\n    viewQuery: function NewStudyNoteComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(CategoriesListComponent, 5);\n        i0.ɵɵviewQuery(TextInputComponent, 5);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.categoryInput = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.textInput = _t.first);\n      }\n    },\n    decls: 17,\n    vars: 6,\n    consts: [[1, \"page-container\"], [1, \"heading-component-container\"], [\"line1Text\", \"New Study Note\"], [1, \"content-container\"], [1, \"group-container\"], [\"type\", \"text\", \"id\", \"titleInput\", \"autocomplete\", \"off\", 1, \"title-input\", 3, \"placeholder\"], [1, \"title-btn\", \"animated-hover\", 3, \"click\"], [\"appearance\", \"fill\", 1, \"subject-selector\"], [3, \"value\", \"valueChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [1, \"tag-selector\", \"search-categories\", 3, \"defaultText\", \"id\", \"doAutoFill\", \"categoryList\"], [1, \"content-input\", 3, \"userInput\"], [3, \"value\"]],\n    template: function NewStudyNoteComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n        i0.ɵɵelement(2, \"app-heading-component\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"div\", 3)(4, \"div\", 4);\n        i0.ɵɵelement(5, \"input\", 5);\n        i0.ɵɵelementStart(6, \"button\", 6);\n        i0.ɵɵlistener(\"click\", function NewStudyNoteComponent_Template_button_click_6_listener() {\n          return ctx.addNote();\n        });\n        i0.ɵɵtext(7, \"Go\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(8, \"div\", 4)(9, \"mat-form-field\", 7)(10, \"label\");\n        i0.ɵɵtext(11, \"Subject\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"mat-select\", 8);\n        i0.ɵɵlistener(\"valueChange\", function NewStudyNoteComponent_Template_mat_select_valueChange_12_listener($event) {\n          return ctx.updateSubject($event);\n        });\n        i0.ɵɵtemplate(13, NewStudyNoteComponent_mat_option_13_Template, 2, 2, \"mat-option\", 9);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(14, \"app-categories-list\", 10);\n        i0.ɵɵlistener(\"categoryList\", function NewStudyNoteComponent_Template_app_categories_list_categoryList_14_listener($event) {\n          return ctx.updateCategoriesList($event);\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(15, \"div\", 4)(16, \"app-text-input\", 11);\n        i0.ɵɵlistener(\"userInput\", function NewStudyNoteComponent_Template_app_text_input_userInput_16_listener($event) {\n          return ctx.updateContent($event);\n        });\n        i0.ɵɵelementEnd()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"placeholder\", \"Title\");\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"value\", ctx.currentSubject);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.totalSubjectsList);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"defaultText\", \"\")(\"id\", \"tagInput\")(\"doAutoFill\", false);\n      }\n    },\n    directives: [i3.HeadingComponentComponent, i4.MatFormField, i5.MatSelect, i6.NgForOf, i7.MatOption, i8.CategoriesListComponent, i9.TextInputComponent],\n    styles: [\".content-container[_ngcontent-%COMP%]{width:85%;display:flex;flex-direction:column;gap:15px;margin:35px auto auto;padding-bottom:0;max-height:90%}.group-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:15px}.title-input[_ngcontent-%COMP%]{flex:.85;background-color:var(--bottom-bg-color);border:none;height:50px;font-size:2rem;border-radius:15px 0}.title-btn[_ngcontent-%COMP%]{flex:.1;width:100%;height:50px;border-radius:0 15px;background-color:var(--mid-bg-color);border:none}.subject-selector[_ngcontent-%COMP%]{flex:.2}.tag-selector[_ngcontent-%COMP%]{flex:.75}.content-input[_ngcontent-%COMP%]{height:55vh;width:100%;padding-bottom:0}.page-container[_ngcontent-%COMP%]{overflow-y:hidden}\"]\n  });\n  return NewStudyNoteComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}